<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dagny — Joy in Motion</title>
<meta name="description" content="Dagny is motion and joy. Harbor clearance flips the lights to pink and opens the floor." />
<!-- dagny · joy in motion -->
<style>
  :root{
    --bg:#0a0a0a;            /* black */
    --ink:#ffffff;           /* white */
    --muted:#cfcfe2;
    --pink:#ff39a8;          /* neon pink */
    --pink2:#ff79c6;         /* soft neon */
    --amber:#ffd089;         /* caution */
    --green:#73e3c5;         /* clear signal */
    --ring:#1a1a1a;
    --card:#0f0f12f2;
    --grid:#1e1e25;
    --shadow:0 10px 30px rgba(0,0,0,.55);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink);
    background:
      repeating-linear-gradient(45deg, #111 0 22px, #000 22px 44px), /* subtle depth layer */
      repeating-conic-gradient(#000 0 25%, #fff 0 50%) 0 0 / 28px 28px; /* checkerboard */
    font: 500 16px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  }
  .wrap{max-width:1100px; margin:0 auto; padding:22px; display:grid; gap:14px}

  /* header */
  .hdr{display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap}
  .title{font-weight:900; font-size:26px; letter-spacing:.4px; text-transform:uppercase}
  .tag{font:700 11px ui-monospace, SFMono-Regular, Menlo, monospace; padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.35); background:rgba(0,0,0,.35)}

  /* cards */
  .card{
    background:linear-gradient(180deg, rgba(12,12,16,.92), rgba(10,10,14,.92));
    border:1px solid rgba(255,255,255,.18);
    border-radius:16px; padding:16px; box-shadow:var(--shadow);
    backdrop-filter:saturate(130%) blur(6px);
  }
  h2{margin:0 0 8px 0; font-size:18px; letter-spacing:.2px}
  .muted{color:var(--muted); font-size:14px}

  /* status ring (Harbor link) */
  .status{
    position:relative; display:grid; grid-template-columns: 180px 1fr; gap:16px; align-items:center;
  }
  @media (max-width:760px){ .status{grid-template-columns: 1fr} }
  .ring{
    position:relative; width:180px; height:180px; border-radius:50%;
    background: radial-gradient(60px at 50% 52%, #131313 0%, #0a0a0a 60%);
    border:2px solid var(--grid);
    box-shadow: inset 0 0 24px rgba(255,255,255,.05), 0 0 0 6px rgba(255,57,168,.05);
    display:flex; align-items:center; justify-content:center; text-align:center; padding:16px;
  }
  .ring::before, .ring::after{
    content:""; position:absolute; inset:-6px; border-radius:50%;
    border:2px dashed rgba(255,255,255,.12);
    animation:spin 14s linear infinite;
  }
  .ring::after{ inset:-14px; opacity:.35; animation-duration: 22s; }
  @keyframes spin{ to{ transform:rotate(360deg)} }

  .state{
    font-weight:900; letter-spacing:.12em; text-transform:uppercase; font-size:11px;
    color:#ffeaff;
  }
  .state b{display:block; font-size:14px; letter-spacing:.18em; color:#fff}
  .substate{display:block; color:var(--muted); font-size:12px; margin-top:6px}

  .ring.ok{
    box-shadow:
      inset 0 0 30px rgba(115,227,197,.15),
      0 0 0 6px rgba(115,227,197,.08),
      0 0 40px rgba(115,227,197,.25);
    border-color: rgba(115,227,197,.6);
  }
  .ring.warn{
    box-shadow:
      inset 0 0 30px rgba(255,208,137,.10),
      0 0 0 6px rgba(255,208,137,.08),
      0 0 40px rgba(255,57,168,.25);
    border-color: rgba(255,208,137,.55);
  }

  .status .copy{color:#ffd9f4}
  .btn{
    display:inline-flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; text-decoration:none; cursor:pointer;
    border:1px solid rgba(255,255,255,.35); color:#fff; font-weight:800; letter-spacing:.2px; text-transform:uppercase;
    background:linear-gradient(180deg, rgba(255,57,168,.18), rgba(255,57,168,.08));
    transition:transform .12s ease, filter .12s ease, box-shadow .12s ease, border-color .12s ease;
  }
  .btn:hover{ transform:translateY(-1px); filter:brightness(1.06)}
  .btn.secondary{ background:linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.04)) }

  /* Harbor → Dagny handshake banner */
  .handshake{
    border:1px solid rgba(255,255,255,.28);
    border-left:4px solid var(--green);
    background:linear-gradient(180deg, rgba(115,227,197,.12), rgba(115,227,197,.06));
    color:#eafff8;
    border-radius:10px;
    padding:10px 12px;
    display:none;        /* hidden until green */
    box-shadow:0 6px 18px rgba(0,0,0,.35);
    font-size:13px;
    margin-top:8px;
  }
  .handshake .stamp{
    font:700 11px ui-monospace, SFMono-Regular, Menlo, monospace;
    color:#cffff3;
    margin-left:8px;
  }

  /* motion stage */
  .stage{
    display:grid; grid-template-columns: 1.2fr .8fr; gap:12px;
  }
  @media (max-width:900px){ .stage{grid-template-columns: 1fr} }
  .queue .track{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    border:1px solid rgba(255,255,255,.2); border-radius:12px; padding:10px; margin:8px 0; background:rgba(255,255,255,.04);
  }
  .titleRow{display:flex; align-items:center; gap:10px}
  .badge{
    padding:3px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.35);
    font:700 11px ui-monospace, SFMono-Regular, Menlo, monospace; color:#ffd9f4;
  }
  .badge.ok{ border-color: rgba(115,227,197,.75); color:#e6fff8 }
  .play{ display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.35); text-decoration:none; color:#fff; background:rgba(255,255,255,.06)}
  .play:hover{ filter:brightness(1.06) }

  /* joy log */
  .log .pad{
    border:1px solid rgba(255,255,255,.28); border-radius:12px; padding:12px; min-height:110px; background:rgba(0,0,0,.35); outline:none; color:#fff;
  }
  .row{display:flex; align-items:center; justify-content:space-between; gap:8px; color:var(--muted); font-size:12px; margin-top:8px}
  .pill{padding:3px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.35); font:700 11px ui-monospace, SFMono-Regular, Menlo, monospace}
  .items{display:grid; gap:8px; margin-top:10px}
  .entry{border:1px solid rgba(255,255,255,.25); border-radius:10px; padding:10px; background:rgba(255,255,255,.04); font-size:14px}
  .stamp{font:700 11px ui-monospace, SFMono-Regular, Menlo, monospace; color:#ffd9f4}

  /* floating confetti (subtle) */
  .float{
    position:absolute; inset:0; pointer-events:none; overflow:hidden; border-radius:14px;
  }
  .dot{
    position:absolute; width:8px; height:8px; border-radius:50%;
    background: radial-gradient(circle at 30% 30%, #fff 0 35%, var(--pink) 36% 100%);
    opacity:.8; animation:rise 9s linear infinite;
  }
  @keyframes rise{
    0%{ transform:translateY(10px) scale(.8); opacity:.0 }
    12%{ opacity:1 }
    100%{ transform:translateY(-120%) scale(1); opacity:0 }
  }

  /* footer links */
  .foot{ text-align:center; color:var(--muted); font-size:12px; padding:8px 0 16px }
  .links{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:8px }
</style>
</head>
<body>
  <main class="wrap">
    <header class="hdr">
      <div class="title">Dagny</div>
      <div class="tag">joy · motion · pink floor</div>
    </header>

    <!-- STATUS / HARBOR LINK -->
    <section class="card">
      <h2>Status</h2>
      <p class="muted">Harbor (Sanela) clears motion. When <em>Credit, Consent,</em> and <em>Resource</em> are green, the floor opens.</p>
      <div class="status">
        <div class="ring warn" id="ring">
          <div>
            <div class="state" id="state-copy">Harbor needed<b>Awaiting clearance</b></div>
            <span class="substate" id="state-sub">credit · consent · resource</span>
          </div>
        </div>
        <div>
          <p class="copy" id="explain">Finish clearance in Harbor before starting motion.</p>
          <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:8px">
            <a class="btn" id="to-harbor" href="https://harbor.plnt.earth" rel="noopener">Go to Harbor</a>
            <a class="btn secondary" href="https://earth.plnt.earth" rel="noopener">Back to Earth</a>
            <a class="btn secondary" href="https://bridge.plnt.earth" rel="noopener">Cross Bridge</a>
          </div>
        </div>
      </div>

      <!-- Harbor → Dagny handshake (shows when green) -->
      <div id="handshake" class="handshake">
        Harbor → Dagny handshake: <span class="stamp" id="handshake-time">—</span>
      </div>
    </section>

    <!-- MOTION STAGE -->
    <section class="card" id="stage">
      <div class="float" aria-hidden="true" id="float"></div>
      <h2>Motion Stage</h2>
      <p class="muted">When Harbor lights go green, the queue unlocks — motion without chase.</p>
      <div class="stage">
        <div class="queue">
          <div class="track">
            <div class="titleRow"><span class="badge ok" id="q-badge">PINK FLOOR</span><span>I Love You Like That</span></div>
            <a class="play" target="_blank" rel="noopener" href="https://www.youtube.com/results?search_query=Dagny+I+Love+You+Like+That">Play</a>
          </div>
          <div class="track">
            <div class="titleRow"><span class="badge">PINK FLOOR</span><span>Somebody</span></div>
            <a class="play" target="_blank" rel="noopener" href="https://www.youtube.com/results?search_query=Dagny+Somebody">Play</a>
          </div>
          <div class="track">
            <div class="titleRow"><span class="badge">PINK FLOOR</span><span>Brightsider</span></div>
            <a class="play" target="_blank" rel="noopener" href="https://www.youtube.com/results?search_query=Dagny+Brightsider">Play</a>
          </div>
        </div>
        <aside class="log">
          <h3>Joy Log</h3>
          <div id="pad" class="pad" contenteditable="true" spellcheck="true" aria-label="What did you move today?"></div>
          <div class="row">
            <span id="count" class="pill">0 chars</span>
            <button id="add" class="btn" type="button" style="background:linear-gradient(180deg, rgba(115,227,197,.18), rgba(115,227,197,.08)); border-color:rgba(115,227,197,.65); color:#eafff5">Add Entry</button>
          </div>
          <div class="items" id="items"></div>
        </aside>
      </div>
    </section>

    <!-- FOOT -->
    <footer class="foot">
      Harbor (Sanela) → Dagny (Motion) · <em>Every clearance becomes dance.</em>
      <div class="links">
        <a class="btn" href="https://harbor.plnt.earth" rel="noopener">Return to Harbor</a>
        <a class="btn secondary" href="https://earth.plnt.earth" rel="noopener">Back to Earth</a>
        <a class="btn secondary" href="https://bridge.plnt.earth" rel="noopener">Cross Bridge</a>
      </div>
    </footer>
  </main>

<script>
  (function(){
    function truthy(v){
      if(v==null) return false;
      var s=String(v).toLowerCase().trim();
      return !(s===""||s==="0"||s==="false"||s==="null"||s==="undefined");
    }

    // ---------- Harbor status ----------
    var credit  = truthy(localStorage.getItem("harbor.credit"));
    var consent = truthy(localStorage.getItem("harbor.consent"));
    var resource= truthy(localStorage.getItem("harbor.resource"));
    var allClear = credit && consent && resource;

    var ring = document.getElementById("ring");
    var stateCopy = document.getElementById("state-copy");
    var stateSub  = document.getElementById("state-sub");
    var explain   = document.getElementById("explain");
    var stage     = document.getElementById("stage");
    var toHarbor  = document.getElementById("to-harbor");

    // Handshake banner elements
    var handshake = document.getElementById("handshake");
    var handshakeTime = document.getElementById("handshake-time");

    function showHandshake(on){
      if(!handshake || !handshakeTime) return;
      if(on){
        var human = localStorage.getItem("harbor.lastClearedHuman") || "";
        if(!human){
          var iso = localStorage.getItem("harbor.lastCleared");
          try{ if(iso){ human = new Date(iso).toLocaleString(); } }catch(e){}
        }
        handshakeTime.textContent = human || "now";
        handshake.style.display = "block";
      }else{
        handshake.style.display = "none";
      }
    }

    if(allClear){
      ring.classList.remove("warn");
      ring.classList.add("ok");
      stateCopy.innerHTML = 'Clear for Motion<b>Harbor confirmed</b>';
      stateSub.textContent = 'credit · consent · resource — all green';
      explain.textContent = 'You’re clear. The pink floor is open — pick a track or add a Joy Log entry.';
      toHarbor.textContent = 'Review Harbor';
      unlockStage(true);
      showHandshake(true);
    }else{
      ring.classList.remove("ok");
      ring.classList.add("warn");
      var missing = [];
      if(!credit)  missing.push("credit");
      if(!consent) missing.push("consent");
      if(!resource)missing.push("resource");
      stateCopy.innerHTML = 'Harbor needed<b>Awaiting clearance</b>';
      stateSub.textContent = missing.join(" · ");
      explain.textContent = 'Finish clearance in Harbor before starting motion.';
      unlockStage(false);
      showHandshake(false);
    }

    function unlockStage(on){
      var plays = stage.querySelectorAll(".play");
      var badges= stage.querySelectorAll(".badge");
      plays.forEach(function(a){
        a.setAttribute("aria-disabled", on? "false":"true");
        a.style.opacity = on? "1":"0.55";
        a.style.pointerEvents = on? "auto":"none";
      });
      badges.forEach(function(b,i){
        if(on){ b.classList.add("ok"); b.textContent = i===0 ? "PINK FLOOR · CLEAR" : "PINK FLOOR"; }
        else { b.classList.remove("ok"); b.textContent = i===0 ? "PINK FLOOR · LOCKED" : "PINK FLOOR"; }
      });
      confetti(on);
    }

    // ---------- Joy Log ----------
    var pad = document.getElementById("pad");
    var count = document.getElementById("count");
    var add = document.getElementById("add");
    var items = document.getElementById("items");

    function updateCount(){ count.textContent = (pad.textContent||"").length + " chars"; }
    pad.addEventListener("input", updateCount, {passive:true});

    function renderItems(){
      items.innerHTML = "";
      var list = [];
      try{ list = JSON.parse(localStorage.getItem("dagny.log.v1")||"[]"); }catch(e){}
      list.forEach(function(it){
        var d = document.createElement("div"); d.className = "entry";
        var s = document.createElement("div"); s.className = "stamp"; s.textContent = it.when;
        var p = document.createElement("div"); p.textContent = it.text;
        d.appendChild(s); d.appendChild(p);
        items.appendChild(d);
      });
    }
    renderItems();

    add.addEventListener("click", function(){
      var t = (pad.textContent||"").trim();
      if(!t) return;
      var list = [];
      try{ list = JSON.parse(localStorage.getItem("dagny.log.v1")||"[]"); }catch(e){}
      list.unshift({ when: new Date().toLocaleString(), text: t });
      try{ localStorage.setItem("dagny.log.v1", JSON.stringify(list)); }catch(e){}
      pad.textContent = "";
      updateCount();
      renderItems();
    }, {passive:true});

    updateCount();

    // ---------- Pink confetti on unlock ----------
    function confetti(on){
      var box = document.getElementById("float");
      box.innerHTML = "";
      if(!on) return;
      for(var i=0;i<24;i++){
        var dot = document.createElement("div");
        dot.className = "dot";
        var left = Math.random()*100;
        var delay = (Math.random()*6).toFixed(2)+"s";
        var dur = (7+Math.random()*5).toFixed(2)+"s";
        dot.style.left = left+"%";
        dot.style.bottom = "-12px";
        dot.style.animationDelay = delay;
        dot.style.animationDuration = dur;
        dot.style.filter = "hue-rotate("+(Math.random()*20-10)+"deg)";
        box.appendChild(dot);
      }
    }
  })();
</script>
</body>
</html>
